+Æ’aÂµSâ€  v1.9.0-+-------------------------------------------------+
| id          | analytics                                       |
| transport   | [URL('kafka://localhost:9092')]                 |
| store       | memory:                                         |
| web         | http://localhost:6066/                          |
| log         | -stderr- (warn)                                 |
| pid         | 20045                                           |
| hostname    | pascal-asus                                     |
| platform    | CPython 3.7.3 (Linux x86_64)                    |
|        +    | Cython (GCC 8.3.0)                              |
| drivers     |                                                 |
|   transport | aiokafka=1.1.3                                  |
|   web       | aiohttp=3.5.4                                   |
| datadir     | /home/hadoop/kafka_2.11-2.3.0/analytics-data    |
| appdir      | /home/hadoop/kafka_2.11-2.3.0/analytics-data/v1 |
+-------------+-------------------------------------------------+
[?25l[2019-10-31 21:59:51,231] [20045] [ERROR] [^---Agent*: analytics.UrlVisitCountBolt]: Crashed reason=UnboundLocalError("local variable 'visit' referenced before assignment") 
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/faust-1.9.0-py3.7-linux-x86_64.egg/faust/agents/agent.py", line 636, in _execute_task
    await coro
  File "/home/hadoop/kafka_2.11-2.3.0/analytics.py", line 73, in UrlVisitCountBolt
    async for visit in visits.group_by( visit.url ):
UnboundLocalError: local variable 'visit' referenced before assignment
[2019-10-31 21:59:51,233] [20045] [ERROR] [^---Agent*: analytics.UserVisitCountBolt]: Crashed reason=UnboundLocalError("local variable 'visit' referenced before assignment") 
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/faust-1.9.0-py3.7-linux-x86_64.egg/faust/agents/agent.py", line 636, in _execute_task
    await coro
  File "/home/hadoop/kafka_2.11-2.3.0/analytics.py", line 80, in UserVisitCountBolt
    async for visit in visits.group_by( visit.userid ):
UnboundLocalError: local variable 'visit' referenced before assignment
[2019-10-31 21:59:56,235] [20045] [ERROR] [^---Agent*: analytics.UrlVisitCountBolt]: Crashed reason=UnboundLocalError("local variable 'visit' referenced before assignment") 
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/faust-1.9.0-py3.7-linux-x86_64.egg/faust/agents/agent.py", line 636, in _execute_task
    await coro
  File "/home/hadoop/kafka_2.11-2.3.0/analytics.py", line 73, in UrlVisitCountBolt
    async for visit in visits.group_by( visit.url ):
UnboundLocalError: local variable 'visit' referenced before assignment
[2019-10-31 21:59:56,236] [20045] [ERROR] [^---Agent*: analytics.UserVisitCountBolt]: Crashed reason=UnboundLocalError("local variable 'visit' referenced before assignment") 
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/faust-1.9.0-py3.7-linux-x86_64.egg/faust/agents/agent.py", line 636, in _execute_task
    await coro
  File "/home/hadoop/kafka_2.11-2.3.0/analytics.py", line 80, in UserVisitCountBolt
    async for visit in visits.group_by( visit.userid ):
UnboundLocalError: local variable 'visit' referenced before assignment
[?25h OK ^
[2019-10-31 22:00:01,238] [20045] [ERROR] [^-App]: Crashed reason=TypeError('Object of type PageVisit is not JSON serializable') 
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/mode-4.1.3-py3.7.egg/mode/services.py", line 770, in _execute_task
    await task
  File "/usr/local/lib/python3.7/dist-packages/faust-1.9.0-py3.7-linux-x86_64.egg/faust/app/base.py", line 922, in _wrapped
    return await task()
  File "/usr/local/lib/python3.7/dist-packages/faust-1.9.0-py3.7-linux-x86_64.egg/faust/app/base.py", line 971, in around_timer
    await fun(*args)
  File "/home/hadoop/kafka_2.11-2.3.0/analytics.py", line 98, in PageVisitSpout
    value=json.dumps( visit ).encode(),
  File "/usr/lib/python3.7/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
  File "/usr/lib/python3.7/json/encoder.py", line 199, in encode
    chunks = self.iterencode(o, _one_shot=True)
  File "/usr/lib/python3.7/json/encoder.py", line 257, in iterencode
    return _iterencode(o, 0)
  File "/usr/lib/python3.7/json/encoder.py", line 179, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type PageVisit is not JSON serializable
[2019-10-31 22:00:01,242] [20045] [ERROR] [^---Agent*: analytics.UrlVisitCountBolt]: Crashed reason=UnboundLocalError("local variable 'visit' referenced before assignment") 
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/faust-1.9.0-py3.7-linux-x86_64.egg/faust/agents/agent.py", line 636, in _execute_task
    await coro
  File "/home/hadoop/kafka_2.11-2.3.0/analytics.py", line 73, in UrlVisitCountBolt
    async for visit in visits.group_by( visit.url ):
UnboundLocalError: local variable 'visit' referenced before assignment
[2019-10-31 22:00:01,242] [20045] [ERROR] [^---Agent*: analytics.UserVisitCountBolt]: Crashed reason=UnboundLocalError("local variable 'visit' referenced before assignment") 
Traceback (most recent call last):
  File "/usr/local/lib/python3.7/dist-packages/faust-1.9.0-py3.7-linux-x86_64.egg/faust/agents/agent.py", line 636, in _execute_task
    await coro
  File "/home/hadoop/kafka_2.11-2.3.0/analytics.py", line 80, in UserVisitCountBolt
    async for visit in visits.group_by( visit.userid ):
UnboundLocalError: local variable 'visit' referenced before assignment
[2019-10-31 22:00:03,243] [20045] [CRITICAL] [^Worker]: We experienced a crash! Reraising original exception... 
[?25h